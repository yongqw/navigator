# 复杂小镇导航系统 (Complex Town Navigation System)

一个具有真实交通模式、转弯限制和详细路径分析的Python导航系统。

## 🌟 主要特性

### 🗺️ 复杂地图设计
- **45个交叉口** - 包括普通交叉口、死胡同等不同类型
- **78条道路** - 4种不同类型的道路（高速公路、主干道、次干道、 local道路）
- **8个地标** - 市政厅、购物中心、住宅区、公园等
- **真实交通限制** - 单行道、禁止左转、禁止右转、禁止掉头

### 🚦 交通规则
- **单行道** - 2条单向道路
- **转弯限制** - 5个禁止左转、5个禁止右转位置
- **交通信号灯** - 20个有信号灯的交叉口
- **速度限制** - 不同道路类型有不同限速（30-80 km/h）

### 📊 路径分析
- **最短路径算法** - 考虑转弯限制的BFS算法
- **距离计算** - 基于坐标的欧几里得距离
- **时间估算** - 基于道路类型和限速的行驶时间
- **路径统计** - 道路类型分析、转弯次数、信号灯数量

### 🎨 可视化功能
- **增强地图显示** - 不同颜色和样式的道路
- **交互式选择** - 点击选择起点和终点
- **实时路径绘制** - 动态显示计算结果
- **详细统计面板** - 路径分析和地标信息

## 📁 文件结构

```
navigator/
├── complex_town_map.json      # 复杂地图数据
├── enhanced_visualize.py      # 增强可视化系统
├── demo_complex_system.py     # 系统演示脚本
├── town_map.py               # 地图数据结构 (已增强)
├── navigation.py             # 导航系统接口
├── pathfinding.py            # 路径查找算法
└── README_complex_system.md  # 本文档
```

## 🚀 快速开始

### 1. 运行交互式地图
```bash
python enhanced_visualize.py
```
- 点击地图选择起点（绿色）
- 再次点击选择终点（紫色）
- 系统自动计算并显示最短路径
- 右侧面板显示详细路径分析

### 2. 运行系统演示
```bash
python demo_complex_system.py
```
- 展示地图信息和地标
- 测试多条路线的路径查找
- 分析交通限制的影响
- 显示连通性统计

### 3. 命令行路径查找
```bash
python navigation.py
```
- 执行随机路线生成
- 显示起点、终点和路径信息

## 🗺️ 地图详情

### 道路类型
- **高速公路** (红色) - 80 km/h，3车道，部分单向
- **主干道** (蓝色) - 50 km/h，2车道
- **次干道** (绿色) - 40 km/h，1车道
- **local道路** (灰色) - 30 km/h，1车道

### 地标位置
- **0** - 市政厅 (政府)
- **5** - 高速公路入口 (交通)
- **17** - 购物中心 (商业)
- **22** - 工业区 (工业)
- **28** - 北住宅区 (住宅)
- **33** - 南住宅区 (住宅)
- **40** - 公园入口 (休闲)
- **44** - 河滨公园 (休闲)

### 交通限制示例
- 禁止左转：7→9→14, 13→14→15, 19→20→21
- 禁止右转：1→7→6, 9→14→13, 15→19→18
- 禁止掉头：0→6→0, 3→9→3, 5→11→5
- 单行道：11→17 (南向), 20→25 (东向), 34→38 (东向)

## 📈 演示结果

### 成功路径示例
- **高速公路→购物中心**: 5→11→15→16→17 (10.47单位, 1.8分钟)
- **北住宅区→南住宅区**: 28→29→33 (9.00单位, 1.8分钟)

### 路径失败示例
- **市政厅→河滨公园**: 因转弯限制无法到达
- **工业区→公园入口**: 因单行道限制无法到达

### 连通性统计
- **交叉口**: 38个普通交叉口 + 7个死胡同
- **交通信号灯**: 20个
- **道路分布**: local道路(53段), 主干道(9段), 次干道(6段), 高速公路(1段)

## 🔧 技术实现

### 核心算法
- **BFS最短路径** - 状态感知的广度优先搜索
- **转弯限制处理** - (当前节点, 前一个节点)状态对
- **距离/时间计算** - 基于道路类型的加权计算

### 数据结构
- **JSON地图格式** - 结构化的地图数据
- **图表示法** - 邻接表和道路属性
- **限制规则** - 可配置的交通规则

## 🎯 使用场景

1. **路径规划** - 找到遵守交通规则的最短路径
2. **交通分析** - 分析不同限制对连通性的影响
3. **地图设计** - 测试不同路网配置的效果
4. **算法教学** - 演示图算法和约束满足问题

## 🚀 扩展建议

1. **实时交通** - 添加动态交通状况
2. **多目标优化** - 最短时间、最少转弯等
3. **可视化增强** - 3D地图、动画路径
4. **数据导入** - 支持OpenStreetMap等真实地图数据
5. **Web界面** - 基于Flask/Django的Web版本

---

*这个复杂小镇导航系统展示了如何处理现实世界中的导航约束，提供了一个功能丰富且直观的交通网络分析工具。*